import{c as I}from"./index.Bhz7cRIx.js";import{a as g}from"./index.CEvxOxeV.js";const r=g(null),N=I(r,e=>e!==null),l=g([]),p=g([]),i=g(!1),u=g(null),S=typeof window<"u";function d(){if(S){const e=r.get();e?(localStorage.setItem("peptide-user",JSON.stringify(e)),localStorage.setItem("peptide-orders",JSON.stringify(l.get())),localStorage.setItem("peptide-addresses",JSON.stringify(p.get()))):(localStorage.removeItem("peptide-user"),localStorage.removeItem("peptide-orders"),localStorage.removeItem("peptide-addresses"))}}if(S){const e=localStorage.getItem("peptide-user"),t=localStorage.getItem("peptide-orders"),a=localStorage.getItem("peptide-addresses");if(e)try{r.set(JSON.parse(e))}catch{r.set(null)}if(t)try{l.set(JSON.parse(t))}catch{l.set([])}if(a)try{p.set(JSON.parse(a))}catch{p.set([])}}function f(){return"usr_"+Math.random().toString(36).substring(2,11)+Date.now().toString(36)}async function v(e,t,a,s){i.set(!0),u.set(null),await new Promise(m=>setTimeout(m,800));const o=JSON.parse(localStorage.getItem("peptide-all-users")||"[]");if(o.find(m=>m.email===e))throw i.set(!1),u.set("An account with this email already exists"),new Error("An account with this email already exists");const n={id:f(),email:e,firstName:a,lastName:s,createdAt:new Date().toISOString(),provider:"email"};return o.push({...n,password:t}),localStorage.setItem("peptide-all-users",JSON.stringify(o)),r.set(n),d(),i.set(!1),n}async function y(e,t){i.set(!0),u.set(null),await new Promise(c=>setTimeout(c,800));const s=JSON.parse(localStorage.getItem("peptide-all-users")||"[]").find(c=>c.email===e&&c.password===t);if(!s)throw i.set(!1),u.set("Invalid email or password"),new Error("Invalid email or password");const{password:o,...n}=s;r.set(n);const w=JSON.parse(localStorage.getItem("peptide-all-orders")||"[]").filter(c=>c.userId===n.id);return l.set(w),d(),i.set(!1),n}async function U(){i.set(!0),u.set(null),await new Promise(t=>setTimeout(t,1200));const e={id:f(),email:"demo.user@gmail.com",firstName:"Demo",lastName:"User",createdAt:new Date().toISOString(),provider:"google",avatar:"https://ui-avatars.com/api/?name=Demo+User&background=0077b6&color=fff"};return r.set(e),d(),i.set(!1),e}async function J(){i.set(!0),u.set(null),await new Promise(t=>setTimeout(t,1200));const e={id:f(),email:"demo.user@facebook.com",firstName:"Demo",lastName:"User",createdAt:new Date().toISOString(),provider:"facebook",avatar:"https://ui-avatars.com/api/?name=Demo+User&background=1877f2&color=fff"};return r.set(e),d(),i.set(!1),e}function D(){r.set(null),l.set([]),p.set([]),d()}function b(e){const t={...e,id:"ORD-"+Math.random().toString(36).substring(2,8).toUpperCase(),date:new Date().toISOString()},a=r.get();if(a){const s=l.get();l.set([t,...s]);const o=JSON.parse(localStorage.getItem("peptide-all-orders")||"[]");o.push({...t,userId:a.id}),localStorage.setItem("peptide-all-orders",JSON.stringify(o)),d()}return t}function A(e){const t=r.get();if(!t)return null;const a={...t,...e};r.set(a);const s=JSON.parse(localStorage.getItem("peptide-all-users")||"[]"),o=s.findIndex(n=>n.id===t.id);return o>-1&&(s[o]={...s[o],...e},localStorage.setItem("peptide-all-users",JSON.stringify(s))),d(),a}export{U as a,J as b,r as c,i as d,u as e,b as f,y as g,l as h,N as i,p as j,D as l,v as r,A as u};
