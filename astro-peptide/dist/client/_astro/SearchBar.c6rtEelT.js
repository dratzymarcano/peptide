import{j as e}from"./jsx-runtime.ClP7wGfN.js";import{r as s}from"./index.DK-fsZOb.js";import{t as c}from"./translations.DwwPAycK.js";function k({lang:l="en"}){const[d,o]=s.useState(!1),[n,i]=s.useState(""),[h,r]=s.useState([]),[x,f]=s.useState(!1),u=s.useRef(null),p=s.useRef(null);s.useEffect(()=>{d&&u.current&&u.current.focus()},[d]),s.useEffect(()=>{const t=m=>{p.current&&!p.current.contains(m.target)&&(o(!1),i(""),r([]))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),s.useEffect(()=>{const m=setTimeout(async()=>{if(n.length<2){r([]);return}f(!0);try{const a=await fetch(`/api/search?q=${encodeURIComponent(n)}`);if(a.ok){const y=await a.json();r(y.results||[])}}catch(a){console.error("Search error:",a)}finally{f(!1)}},300);return()=>clearTimeout(m)},[n]);const j=t=>{t.key==="Escape"&&(o(!1),i(""),r([]))};return e.jsx("div",{ref:p,className:"position-relative",children:d?e.jsxs("div",{className:"search-container",style:{minWidth:"280px"},children:[e.jsxs("div",{className:"input-group",children:[e.jsx("input",{ref:u,type:"text",className:"form-control form-control-sm",placeholder:c(l,"nav.search"),value:n,onChange:t=>i(t.target.value),onKeyDown:j,style:{borderRadius:"20px 0 0 20px",paddingLeft:"15px"}}),e.jsx("div",{className:"input-group-append",children:e.jsx("button",{className:"btn btn-sm btn-light",type:"button",onClick:()=>{o(!1),i(""),r([])},style:{borderRadius:"0 20px 20px 0"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]})})})]}),(h.length>0||x)&&e.jsx("div",{className:"search-results bg-white shadow rounded mt-2",style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:x?e.jsx("div",{className:"p-3 text-center text-muted",children:e.jsx("small",{children:c(l,"common.searching")})}):h.map(t=>e.jsxs("a",{href:t.slug,className:"d-flex align-items-center p-2 px-3 text-dark border-bottom search-result-item",style:{textDecoration:"none",gap:"10px"},onClick:()=>{o(!1),i(""),r([])},children:[e.jsxs("div",{style:{width:"28px",height:"28px",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:t.type==="product"?"#0077b6":t.type==="blog"?"#059669":"#6366f1",color:"white",flexShrink:0},children:[t.type==="product"&&e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("path",{d:"M16 10a4 4 0 0 1-8 0"})]}),t.type==="blog"&&e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),t.type==="page"&&e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})]}),e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.title}),e.jsx("small",{className:"text-muted",style:{textTransform:"capitalize"},children:t.category})]})]},t.id))}),n.length>=2&&!x&&h.length===0&&e.jsx("div",{className:"search-results bg-white shadow rounded mt-2 p-3",style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3},children:e.jsx("div",{className:"text-center text-muted",children:e.jsx("small",{children:c(l,"common.noResultsFound").replace("{query}",n)})})})]}):e.jsx("button",{onClick:()=>o(!0),className:"btn btn-link text-dark p-0",style:{textDecoration:"none"},"aria-label":c(l,"common.searchLabel"),children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]})})})}export{k as default};
