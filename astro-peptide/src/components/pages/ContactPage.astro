---
import Layout from '../../layouts/Layout.astro';
import PageTitle from '../../components/PageTitle.astro';
import { getEntry } from 'astro:content';
import { t, getLocalizedPath } from '../../i18n/translations';
import type { SupportedLanguage } from '../../i18n/translations';

interface Props {
  lang: SupportedLanguage;
}

const { lang } = Astro.props;
const siteCopy = await getEntry('site', 'en');
const siteData = siteCopy?.data;
const contactEmail = siteData?.email ?? 'peptideshop@zohomail.com';

const breadcrumbs = [
  { name: t(lang, 'nav.home'), url: lang === 'en' ? '/' : `/${lang}` },
  { name: t(lang, 'nav.contact'), url: getLocalizedPath('/contact/', lang) }
];

const contactSchema = {
  "@context": "https://schema.org",
  "@type": "ContactPage",
  "name": t(lang, 'contactPage.title'),
  "description": t(lang, 'contactPage.subtitle'),
  "url": Astro.url.toString(),
  "mainEntity": {
    "@type": "Organization",
    "name": "Peptide Shop",
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+44-123-456-7890",
      "contactType": "customer service",
      "email": contactEmail
    }
  }
};
---

<Layout 
  title={`${t(lang, 'contactPage.title')} | Peptide Shop`}
  description={t(lang, 'contactPage.subtitle')}
  breadcrumbs={breadcrumbs}
  schema={contactSchema}
>
  
  <style>
    /* Mobile-first responsive styles for Contact page */
    @media (max-width: 767px) {
      section[style*="padding: 80px 0"] {
        padding: 40px 0 !important;
      }
      
      div[style*="padding: 40px"] {
        padding: 24px !important;
      }
      
      div[style*="padding: 32px"] {
        padding: 20px !important;
      }
      
      h2 {
        font-size: 1.5rem !important;
      }
      
      p[style*="font-size: 1.25rem"] {
        font-size: 1rem !important;
      }
      
      /* Info cards stack first on mobile */
      .col-lg-5 {
        order: -1;
        margin-bottom: 32px;
      }
      
      .col-lg-5 > div[style*="position: sticky"] {
        position: relative !important;
        top: 0 !important;
      }
      
      /* Form inputs larger touch targets */
      input.form-control,
      textarea.form-control {
        min-height: 48px;
        font-size: 16px !important; /* Prevent zoom on iOS */
      }
      
      button[type="submit"] {
        min-height: 52px;
      }
    }
    
    @media (max-width: 575px) {
      div[style*="padding: 24px"] {
        padding: 16px !important;
      }
      
      .breadcrumb {
        font-size: 12px;
      }
      
      /* Stack name/email fields */
      .col-md-6 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }
  </style>

  <PageTitle 
    title={t(lang, 'contactPage.title')}
    subtitle={t(lang, 'contactPage.subtitle')}
    breadcrumbs={breadcrumbs}
  />

  <!-- Contact Form & Info Section -->
  <section style="padding: 80px 0; background: white;">
    <div class="container">
      <div class="row g-5">
        <!-- Contact Form -->
        <div class="col-lg-7">
          <div style="background: white; border-radius: 10px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
            <h2 style="color: #1e293b; font-weight: 700; margin-bottom: 24px; font-size: 1.75rem;">
              {t(lang, 'contactPage.section.sendMessage')}
            </h2>
            <form id="contact-form">
              <div class="row g-3">
                <div class="col-md-6">
                  <label style="display: block; color: #64748b; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                    {t(lang, 'contactPage.form.name')}
                  </label>
                  <input 
                    name="user_name" 
                    type="text" 
                    class="form-control" 
                    placeholder={t(lang, 'contactPage.form.namePlaceholder')}
                    style="padding: 14px 16px; border: 2px solid rgba(0,0,0,0.1); border-radius: 10px; font-size: 15px;"
                    required
                  >
                </div>
                <div class="col-md-6">
                  <label style="display: block; color: #64748b; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                    {t(lang, 'contactPage.form.email')}
                  </label>
                  <input 
                    name="user_email" 
                    type="email" 
                    class="form-control" 
                    placeholder={t(lang, 'contactPage.form.emailPlaceholder')}
                    style="padding: 14px 16px; border: 2px solid rgba(0,0,0,0.1); border-radius: 10px; font-size: 15px;"
                    required
                  >
                </div>
                <div class="col-12">
                  <label style="display: block; color: #64748b; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                    {t(lang, 'contactPage.form.subject')}
                  </label>
                  <input 
                    name="subject" 
                    type="text" 
                    class="form-control" 
                    placeholder={t(lang, 'contactPage.form.subjectPlaceholder')}
                    style="padding: 14px 16px; border: 2px solid rgba(0,0,0,0.1); border-radius: 10px; font-size: 15px;"
                  >
                </div>
                <div class="col-12">
                  <label style="display: block; color: #64748b; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                    {t(lang, 'contactPage.form.message')}
                  </label>
                  <textarea 
                    name="user_message" 
                    class="form-control" 
                    rows="6" 
                    placeholder={t(lang, 'contactPage.form.messagePlaceholder')}
                    style="padding: 14px 16px; border: 2px solid rgba(0,0,0,0.1); border-radius: 10px; font-size: 15px; resize: vertical;"
                    required
                  ></textarea>
                </div>
                <div class="col-12">
                  <button 
                    class="btn btn-main" 
                    type="submit"
                    style="padding: 16px 40px; background: linear-gradient(90deg, #0077b6, #023e8a); border: none; border-radius: 10px; color: white; font-weight: 700; font-size: 16px; width: 100%; transition: all 0.3s;"
                  >
                    {t(lang, 'contactPage.form.submit')}
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Contact Info Cards -->
        <div class="col-lg-5">
          <div style="position: sticky; top: 100px;">
            <!-- Email Card -->
            <div style="background: linear-gradient(135deg, rgba(0, 119, 182, 0.1), rgba(0, 150, 199, 0.1)); border-radius: 10px; padding: 32px; margin-bottom: 24px; border: 2px solid rgba(0, 119, 182, 0.2);">
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #0077b6, #023e8a); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                  <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                </svg>
              </div>
              <h3 style="color: #1e293b; font-weight: 700; font-size: 1.25rem; margin-bottom: 8px;">{t(lang, 'contactPage.info.emailTitle')}</h3>
              <p style="color: #64748b; margin-bottom: 12px; font-size: 14px;">{t(lang, 'contactPage.info.emailSubtitle')}</p>
              <a href={`mailto:${contactEmail}`} style="color: #0077b6; font-weight: 600; text-decoration: none; font-size: 1.125rem;">
                {contactEmail}
              </a>
            </div>

            <!-- Phone Card -->
            <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); border-radius: 10px; padding: 32px; margin-bottom: 24px; border: 2px solid rgba(16, 185, 129, 0.2);">
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                </svg>
              </div>
              <h3 style="color: #1e293b; font-weight: 700; font-size: 1.25rem; margin-bottom: 8px;">{t(lang, 'contactPage.info.callTitle')}</h3>
              <p style="color: #64748b; margin-bottom: 12px; font-size: 14px;">{t(lang, 'contactPage.info.callSubtitle')}</p>
              <a href="tel:+441234567890" style="color: #10b981; font-weight: 600; text-decoration: none; font-size: 1.125rem;">
                +44 (0) 123 456 7890
              </a>
            </div>

            <!-- Location Card -->
            <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); border-radius: 10px; padding: 32px; border: 2px solid rgba(245, 158, 11, 0.2);">
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                  <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
              </div>
              <h3 style="color: #1e293b; font-weight: 700; font-size: 1.25rem; margin-bottom: 8px;">{t(lang, 'contactPage.info.locationTitle')}</h3>
              <p style="color: #64748b; margin: 0; font-size: 15px; line-height: 1.6;" set:html={t(lang, 'contactPage.info.locationValue')} />
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script define:vars={{ successMessage: t(lang, 'contactPage.successMessage') }}>
  const contactForm = document.getElementById('contact-form');
  contactForm?.addEventListener('submit', function(e) {
    e.preventDefault();
    alert(successMessage);
    e.target.reset();
  });
</script>
