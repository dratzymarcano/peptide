---
import Layout from '../../layouts/Layout.astro';
import PageTitle from '../../components/PageTitle.astro';
import { t, getLocalizedPath, type SupportedLanguage } from '../../i18n/translations';

interface Props {
  lang: SupportedLanguage;
}

const { lang } = Astro.props;

const bundles = [
  {
    id: "recovery-stack",
    name: "Recovery Research Stack",
    tagline: t(lang, 'bundlesPage.recoveryTagline'),
    description: t(lang, 'bundlesPage.recoveryDescription'),
    products: [
      { name: "BPC-157", size: "10mg", href: getLocalizedPath('/peptides/buy-bpc-157', lang), price: 65 },
      { name: "TB-500", size: "10mg", href: getLocalizedPath('/peptides/buy-tb-500', lang), price: 55 },
      { name: "Bacteriostatic Water", size: "10ml x2", href: getLocalizedPath('/peptides/buy-bacteriostatic-water', lang), price: 16 }
    ],
    originalPrice: 136,
    bundlePrice: 115,
    savings: 21,
    savingsPercent: 15,
    features: [
      t(lang, 'bundlesPage.features.synergistic'),
      t(lang, 'bundlesPage.features.complementary'),
      t(lang, 'bundlesPage.features.complete'),
      t(lang, 'bundlesPage.features.popular')
    ],
    color: "#0077b6"
  },
  {
    id: "weight-research-stack",
    name: "Metabolic Research Stack",
    tagline: t(lang, 'bundlesPage.metabolicTagline'),
    description: t(lang, 'bundlesPage.metabolicDescription'),
    products: [
      { name: "Semaglutide", size: "5mg", href: getLocalizedPath('/peptides/buy-semaglutide', lang), price: 85 },
      { name: "Tirzepatide", size: "5mg", href: getLocalizedPath('/peptides/buy-tirzepatide', lang), price: 95 },
      { name: "Bacteriostatic Water", size: "10ml x2", href: getLocalizedPath('/peptides/buy-bacteriostatic-water', lang), price: 16 }
    ],
    originalPrice: 196,
    bundlePrice: 165,
    savings: 31,
    savingsPercent: 16,
    features: [
      t(lang, 'bundlesPage.features.glp1'),
      t(lang, 'bundlesPage.features.dualAgonist'),
      t(lang, 'bundlesPage.features.metabolic'),
      t(lang, 'bundlesPage.features.suppliesIncluded')
    ],
    color: "#7c3aed",
    popular: true
  },
  {
    id: "gh-stack",
    name: "Growth Hormone Stack",
    tagline: t(lang, 'bundlesPage.ghTagline'),
    description: t(lang, 'bundlesPage.ghDescription'),
    products: [
      { name: "CJC-1295 (No DAC)", size: "5mg", href: getLocalizedPath('/peptides/buy-cjc-1295-no-dac', lang), price: 45 },
      { name: "Ipamorelin", size: "5mg", href: getLocalizedPath('/peptides/buy-ipamorelin', lang), price: 40 },
      { name: "GHRP-6", size: "5mg", href: getLocalizedPath('/peptides/buy-ghrp-6', lang), price: 35 },
      { name: "Bacteriostatic Water", size: "10ml x2", href: getLocalizedPath('/peptides/buy-bacteriostatic-water', lang), price: 16 }
    ],
    originalPrice: 136,
    bundlePrice: 115,
    savings: 21,
    savingsPercent: 15,
    features: [
      t(lang, 'bundlesPage.features.ghrhSynergy'),
      t(lang, 'bundlesPage.features.multipleSecretagogues'),
      t(lang, 'bundlesPage.features.ghPulse'),
      t(lang, 'bundlesPage.features.reconstitution')
    ],
    color: "#059669"
  },
  {
    id: "cognitive-stack",
    name: "Cognitive Research Stack",
    tagline: t(lang, 'bundlesPage.cognitiveTagline'),
    description: t(lang, 'bundlesPage.cognitiveDescription'),
    products: [
      { name: "Semax", size: "30mg", href: getLocalizedPath('/peptides/buy-semax', lang), price: 55 },
      { name: "Selank", size: "10mg", href: getLocalizedPath('/peptides/buy-selank', lang), price: 50 },
      { name: "Bacteriostatic Water", size: "10ml x2", href: getLocalizedPath('/peptides/buy-bacteriostatic-water', lang), price: 16 }
    ],
    originalPrice: 121,
    bundlePrice: 99,
    savings: 22,
    savingsPercent: 18,
    features: [
      t(lang, 'bundlesPage.features.bdnf'),
      t(lang, 'bundlesPage.features.neuroprotection'),
      t(lang, 'bundlesPage.features.complementaryMechanisms'),
      t(lang, 'bundlesPage.features.cognitiveEnhancement')
    ],
    color: "#0891b2"
  },
  {
    id: "starter-kit",
    name: "Peptide Starter Kit",
    tagline: t(lang, 'bundlesPage.starterTagline'),
    description: t(lang, 'bundlesPage.starterDescription'),
    products: [
      { name: "BPC-157", size: "5mg", href: getLocalizedPath('/peptides/buy-bpc-157', lang), price: 35 },
      { name: "Bacteriostatic Water", size: "10ml x3", href: getLocalizedPath('/peptides/buy-bacteriostatic-water', lang), price: 24 }
    ],
    originalPrice: 59,
    bundlePrice: 49,
    savings: 10,
    savingsPercent: 17,
    features: [
      t(lang, 'bundlesPage.features.beginnerFriendly'),
      t(lang, 'bundlesPage.features.completeSupplies'),
      t(lang, 'bundlesPage.features.popularPeptide'),
      t(lang, 'bundlesPage.features.excellentValue')
    ],
    color: "#f59e0b"
  }
];
---

<Layout 
  title={`${t(lang, 'bundlesPage.title')} | Peptide Shop`}
  description={t(lang, 'bundlesPage.description')}
  breadcrumbs={[
    { name: t(lang, 'nav.home'), url: getLocalizedPath('/', lang) },
    { name: t(lang, 'bundlesPage.title'), url: getLocalizedPath('/bundles', lang) }
  ]}
>
  <style>
    .bundles-hero {
      background: linear-gradient(135deg, #0077b6 0%, #023e8a 100%);
      padding: 100px 0 80px;
      position: relative;
      overflow: hidden;
    }
    
    .bundles-hero::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 60%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 60%);
    }
    
    .hero-content {
      position: relative;
      z-index: 2;
    }
    
    .hero-badge {
      display: inline-block;
      background: rgba(255,255,255,0.15);
      color: white;
      padding: 8px 20px;
      border-radius: 30px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 24px;
    }
    
    .hero-title {
      color: white;
      font-size: 3rem;
      font-weight: 800;
      line-height: 1.1;
      margin-bottom: 20px;
    }
    
    .hero-description {
      color: rgba(255,255,255,0.9);
      font-size: 1.25rem;
      max-width: 600px;
      line-height: 1.7;
    }
    
    .bundles-section {
      padding: 80px 0;
      background: #f8fafc;
    }
    
    .bundles-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 32px;
    }
    
    @media (max-width: 991px) {
      .bundles-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .bundle-card {
      background: white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.06);
      transition: all 0.3s;
      position: relative;
    }
    
    .bundle-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.12);
    }
    
    .bundle-card.featured {
      border: 3px solid #7c3aed;
    }
    
    .popular-tag {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #7c3aed;
      color: white;
      padding: 6px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
    }
    
    .bundle-header {
      padding: 32px 32px 24px;
      border-bottom: 1px solid #f1f5f9;
    }
    
    .bundle-tagline {
      color: #64748b;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    .bundle-name {
      font-size: 1.5rem;
      font-weight: 800;
      color: #1e293b;
      margin-bottom: 12px;
    }
    
    .bundle-description {
      color: #64748b;
      line-height: 1.6;
    }
    
    .bundle-products {
      padding: 24px 32px;
      background: #f8fafc;
    }
    
    .product-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .product-row:last-child {
      border-bottom: none;
    }
    
    .product-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .product-link {
      color: #1e293b;
      text-decoration: none;
      font-weight: 600;
    }
    
    .product-link:hover {
      color: #0077b6;
    }
    
    .product-size {
      color: #64748b;
      font-size: 14px;
    }
    
    .product-price {
      color: #64748b;
      font-size: 14px;
    }
    
    .bundle-features {
      padding: 24px 32px;
      border-bottom: 1px solid #f1f5f9;
    }
    
    .features-list {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    
    @media (max-width: 575px) {
      .features-list {
        grid-template-columns: 1fr;
      }
    }
    
    .feature-item {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #475569;
      font-size: 14px;
    }
    
    .feature-item svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    
    .bundle-footer {
      padding: 24px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    @media (max-width: 575px) {
      .bundle-footer {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }
    }
    
    .price-block {
      display: flex;
      align-items: baseline;
      gap: 12px;
    }
    
    .original-price {
      color: #94a3b8;
      font-size: 1rem;
      text-decoration: line-through;
    }
    
    .bundle-price {
      font-size: 2rem;
      font-weight: 800;
      color: #1e293b;
    }
    
    .savings-badge {
      background: #dcfce7;
      color: #16a34a;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
    }
    
    .add-bundle-btn {
      background: linear-gradient(135deg, #0077b6, #023e8a);
      color: white;
      padding: 14px 28px;
      border-radius: 10px;
      font-weight: 700;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
    }
    
    .add-bundle-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 119, 182, 0.3);
    }
  </style>

  <!-- Hero Section -->
  <section class="bundles-hero">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-8 hero-content">
          <span class="hero-badge">{t(lang, 'bundlesPage.saveBadge')}</span>
          <h1 class="hero-title">{t(lang, 'bundlesPage.heroTitle')}</h1>
          <p class="hero-description">{t(lang, 'bundlesPage.heroDescription')}</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Bundles Grid -->
  <section class="bundles-section">
    <div class="container">
      <div class="bundles-grid">
        {bundles.map((bundle) => (
          <div class={`bundle-card ${bundle.popular ? 'featured' : ''}`}>
            {bundle.popular && <span class="popular-tag">{t(lang, 'bundlesPage.mostPopular')}</span>}
            
            <div class="bundle-header">
              <p class="bundle-tagline">{bundle.tagline}</p>
              <h2 class="bundle-name">{bundle.name}</h2>
              <p class="bundle-description">{bundle.description}</p>
            </div>
            
            <div class="bundle-products">
              {bundle.products.map((product) => (
                <div class="product-row">
                  <div class="product-info">
                    <a href={product.href} class="product-link">{product.name}</a>
                    <span class="product-size">{product.size}</span>
                  </div>
                  <span class="product-price">£{product.price}</span>
                </div>
              ))}
            </div>
            
            <div class="bundle-features">
              <div class="features-list">
                {bundle.features.map((feature) => (
                  <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke={bundle.color} stroke-width="2">
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    {feature}
                  </div>
                ))}
              </div>
            </div>
            
            <div class="bundle-footer">
              <div class="price-block">
                <span class="original-price">£{bundle.originalPrice}</span>
                <span class="bundle-price">£{bundle.bundlePrice}</span>
                <span class="savings-badge">{t(lang, 'bundlesPage.save')} £{bundle.savings}</span>
              </div>
              <button 
                class="add-bundle-btn"
                onclick={`addBundleToCart('${bundle.id}', '${bundle.name}', ${bundle.bundlePrice})`}
              >
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                {t(lang, 'bundlesPage.addToCart')}
              </button>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <script is:inline>
    window.addBundleToCart = function addBundleToCart(bundleId, bundleName, bundlePrice) {
      let cart = JSON.parse(localStorage.getItem('cart') || '[]');
      const existingIndex = cart.findIndex(item => item.id === bundleId);
      
      if (existingIndex > -1) {
        cart[existingIndex].quantity += 1;
      } else {
        cart.push({
          id: bundleId,
          name: bundleName,
          price: bundlePrice,
          quantity: 1,
          type: 'bundle'
        });
      }
      
      localStorage.setItem('cart', JSON.stringify(cart));
      
      const cartCount = document.querySelector('.cart-count');
      if (cartCount) {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
      }
      
      alert(`${bundleName} added to cart!`);
    }
  </script>
</Layout>
